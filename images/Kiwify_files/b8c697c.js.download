(window.webpackJsonp=window.webpackJsonp||[]).push([[208],{1966:function(t,e,n){var content=n(2054);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(24).default)("413f0124",content,!0,{sourceMap:!1})},2053:function(t,e,n){"use strict";n(1966)},2054:function(t,e,n){var o=n(23)((function(i){return i[1]}));o.push([t.i,".otp-input{\n  width:45px;\n  height:45px;\n  padding:5px;\n  margin-right:10px;\n  font-size:20px;\n  border-radius:4px;\n  border:2px solid hsla(0,0%,44.7%,.3);\n  text-align:center\n}\n.otp-input:focus{\n  outline:none\n}\n.otp-input-error{\n  border:1px solid red!important\n}\n.otp-input::-webkit-inner-spin-button,.otp-input::-webkit-outer-spin-button{\n  -webkit-appearance:none;\n  margin:0\n}",""]),o.locals={},t.exports=o},2281:function(t,e,n){"use strict";n.r(e);var o=n(4),r=(n(29),n(50),n(30),n(53),n(18)),c={props:{value:{type:Boolean}},data:function(){return{isOpen:!!this.value,isLoading:!1,otp:null}},computed:{inputClasses:function(){var t="otp-input";return this.serverError&&(t+=" otp-input-error"),t}},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$recaptcha.init();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))()},watch:{value:function(){this.value&&this.requestCodeSms()}},methods:{onCancel:function(){this.$emit("onClose")},getDescription:function(){var t=this.$root.$options.filters.formatCellphoneBrazil(this.$store.state.profile.user.mobile);return this.$t("myAccount.verifySms.description",{phone:t})},requestCodeSms:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.t0=t.$axios,e.next=5,t.$recaptcha.execute();case 5:return e.t1=e.sent,e.t2={recaptcha_token:e.t1},e.next=9,e.t0.post.call(e.t0,"/otp/sms-recovery",e.t2);case 9:e.next=15;break;case 11:e.prev=11,e.t3=e.catch(1),t.$notification({text:t.$t("defaults.components.otpSms.error.generateCode"),color:"red"}),console.log(e.t3);case 15:return e.prev=15,t.isLoading=!1,e.finish(15);case 18:case 19:case"end":return e.stop()}}),e,null,[[1,11,15,18]])})))()},onComplete:function(t){this.otp=t,this.isLoading=!0,this.validateCode()},validateCode:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=t.$axios,e.next=4,t.$recaptcha.execute();case 4:return e.t1=e.sent,e.t2=t.otp,e.t3={recaptcha_token:e.t1,code:e.t2},e.next=9,e.t0.post.call(e.t0,"/otp/sms-confirmed",e.t3);case 9:n=e.sent,localStorage.setItem("kiwi_device_token_"+t.profile.user.external_id,n.data.device_token),window.location.replace(decodeURIComponent("/myprofile?recoverySms=true")),e.next=19;break;case 14:e.prev=14,e.t4=e.catch(0),t.$notification({text:t.$t("defaults.components.otpSms.modal.error.codeIncorrect"),color:"red"}),t.isLoading=!1,console.log(e.t4);case 19:case"end":return e.stop()}}),e,null,[[0,14]])})))()}}},l=(n(2053),n(0)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Modal",{attrs:{title:t.$t("myAccount.verifySms.titleStepOne"),description:t.getDescription(),noButtons:"",width:"max-w-lg",closeButton:"",isLoading:t.isLoading},on:{onCancel:function(e){return t.onCancel()}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[t.isLoading?n("section",{staticClass:"flex justify-center items-center"},[n("svg",{staticClass:"animate-spin mx-2 h-5 w-5 text-black",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"}},[n("circle",{staticClass:"opacity-25",attrs:{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}}),t._v(" "),n("path",{staticClass:"opacity-75",attrs:{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"}})])]):n("section",[n("section",[n("div",{staticClass:"my-8"},[n("v-otp-input",{ref:"otpInput",staticClass:"justify-center flex",attrs:{"input-classes":t.inputClasses,separator:"","num-inputs":6,"should-auto-focus":!0,"is-input-num":!0},on:{"on-change":function(e){t.otp=e,t.serverError=!1},"on-complete":t.onComplete}})],1)]),t._v(" "),n("p",{staticClass:"text-sm text-center"},[t._v("\n      "+t._s(t.$t("defaults.components.otpSms.noAccessPhoneNumber"))+"\n      "),n("label",{staticClass:"font-medium text-indigo-600 hover:text-indigo-500 focus:outline-none focus:underline transition ease-in-out duration-150 cursor-pointer",on:{click:function(e){return t.$emit("flowUnico")}}},[t._v("\n        "+t._s(t.$t("defaults.components.otpSms.click"))+"\n      ")])])])])}),[],!1,null,null,null),d=component.exports;installComponents(component,{Modal:n(132).default});var m={props:{value:{type:Boolean}},data:function(){return{isOpen:!!this.value,isLoading:!1,qrcode:void 0,countDownToTime:null,timerOutput:null,otp:null,interval:null}},computed:{statusLoginWithoutOtp:function(){return this.$store.state.statusLoginWithoutOtp}},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.interval=setInterval((function(){t.startTimer()}),1e3),e.prev=1,e.next=4,t.$recaptcha.init();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})))()},watch:{value:function(){this.value&&this.getQrCodeData()},statusLoginWithoutOtp:{handler:function(){"approved"===this.statusLoginWithoutOtp.status&&this.getDeviceTokenAndRedirectToMyProfile()}}},methods:{onCancel:function(){this.$emit("onClose")},getDescription:function(){return"declined"!==this.statusLoginWithoutOtp.status?this.$t("defaults.components.otpSms.modal.finishInPhone"):""},getQrCodeData:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.t0=t.$axios,e.next=5,t.$recaptcha.execute();case 5:return e.t1=e.sent,e.t2={recaptcha_token:e.t1},e.next=9,e.t0.post.call(e.t0,"/otp/loginWithoutOtp",e.t2);case 9:n=e.sent,t.currentStepIndex=1,t.countDownToTime=new Date(n.data.data.expires_at).getTime(),t.qrcode={qr_code:n.data.data.qr_code,url:n.data.data.url},e.next=19;break;case 15:e.prev=15,e.t3=e.catch(1),t.$notification({text:t.$t("defaults.components.otpSms.modal.error.generic"),color:"red"}),t.onCancel();case 19:return e.prev=19,t.isLoading=!1,e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[1,15,19,22]])})))()},getDeviceTokenAndRedirectToMyProfile:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=t.$axios,e.t1="/otp/loginWithoutOtp/".concat(t.statusLoginWithoutOtp.id,"/confirm"),e.next=5,t.$recaptcha.execute();case 5:return e.t2=e.sent,e.t3={recaptcha_token:e.t2},e.next=9,e.t0.post.call(e.t0,e.t1,e.t3);case 9:n=e.sent,localStorage.setItem("kiwi_device_token_"+t.profile.user.external_id,n.data.device_token),window.location.replace(decodeURIComponent("/myprofile?recoverySms=true")),e.next=18;break;case 14:e.prev=14,e.t4=e.catch(0),t.$notification({text:t.$t("defaults.components.otpSms.modal.error.generic"),color:"red"}),t.onCancel();case 18:return e.prev=18,t.isLoading=!1,e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[0,14,18,21]])})))()},startTimer:function(){if(this.countDownToTime){var t=(new Date).getTime(),e=this.countDownToTime-t;if(e<0)this.countDownToTime="0:00",clearInterval(this.interval),this.onCancel(),this.$notification({text:this.$t("defaults.components.otpSms.modal.error.expiredTime"),color:"red"});else{var n=6e4,o=e%36e5/n,r=e%n/1e3,c=Math.floor(o),l=Math.floor(r);this.timerOutput=c+":"+(l<10?"0"+l:l)}}}}},f=Object(l.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Modal",{attrs:{title:t.$t("myAccount.verifySms.titleStepTwo"),description:t.getDescription(),noButtons:"",width:"sm:max-w-2xl",closeButton:"",isLoading:t.isLoading},on:{onCancel:function(e){return t.onCancel()}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},[t.isLoading?n("section",{staticClass:"flex justify-center items-center"},[n("svg",{staticClass:"animate-spin mx-2 h-5 w-5 text-black",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"}},[n("circle",{staticClass:"opacity-25",attrs:{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}}),t._v(" "),n("path",{staticClass:"opacity-75",attrs:{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"}})])]):n("section",[n("section",["declined"===t.statusLoginWithoutOtp.status?n("section",[n("div",{staticClass:"bg-red-50 p-4 text-red-700 mb-8"},[n("div",{staticClass:"text-2xl font-medium"},[t._v("\n          "+t._s(t.$t("finance.list.identity").declined.title)+"\n        ")]),t._v(" "),n("div",{staticClass:"text-sm leading-5"},[t._v(t._s(t.$t("finance.list.identity").declined.description))]),t._v(" "),n("div",{staticClass:"text-sm mx-auto",domProps:{innerHTML:t._s(t.$t("finance.list.identity").declined.info)}})])]):n("section",[n("section",{staticClass:"flex justify-end"},[n("p",{staticClass:"w-80 text-sm text-gray-500 my-2 text-center mr-8",domProps:{innerHTML:t._s(t.$t("defaults.components.otpSms.modal.timeToFinish",{time:t.timerOutput}))}})]),t._v(" "),t.qrcode?n("VerifyIdentityQRLink",{attrs:{qr:t.qrcode}}):t._e()],1)])])])}),[],!1,null,null,null),v=f.exports;installComponents(f,{VerifyIdentityQRLink:n(1802).default,Modal:n(132).default});n(11);var h={layout:"Navbar",components:{ModalRecoveryWithSms:d,ModalRecoveryWithUnico:v},validations:{otp:{required:r.required,minLength:Object(r.minLength)(6),maxLength:Object(r.maxLength)(6)}},data:function(){return{time:0,otp:null,isLoading:!1,mounted:!0,loadingStates:{otp:!1},modalStates:{recoveryWithSms:!1,recoveryWithUnico:!1}}},computed:{profile:function(){return this.$store.state.profile},onboardCompleted:function(){return!(!this.$store.state.profile.myStore||!this.$store.state.profile.myStore.onboarding_status||"completed"!==this.$store.state.profile.myStore.onboarding_status)}},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $crisp.push(["do","chat:show"]),n=t,setInterval((function(){var t=localStorage.endTime-new Date;t>=0&&(n.time=Math.floor(t/1e3))}),100),e.prev=3,e.next=6,t.$recaptcha.init();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),console.log(e.t0);case 11:0===t.time&&t.getOTP(),t.$store.commit("PUSHER_INIT",{});case 14:case"end":return e.stop()}}),e,null,[[3,8]])})))()},methods:{login:function(){var t=this;this.$v.otp.$touch(),this.$v.otp.$error||(this.isLoading=!0,setTimeout((function(){t.isLoading=!1}),1e3))},getOTP:function(t){var e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,e.loadingStates.otp=!0,t&&(e.mounted=!1),n.next=5,e.$axios.post("/otp",{recaptcha_token:"xxs"});case 5:n.sent,e.startTimer(),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),e.$notification({text:"OTP Email Failed",color:"red"}),console.log(n.t0);case 13:return n.prev=13,e.loadingStates.otp=!1,n.finish(13);case 16:case"end":return n.stop()}}),n,null,[[0,9,13,16]])})))()},verifyOTP:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.$v.otp.$touch(),t.$v.otp.$error){e.next=9;break}return t.isLoading=!0,e.next=6,t.$axios.put("/otp/".concat(t.otp,"/confirm"),{recaptcha_token:"xxs"});case 6:n=e.sent,localStorage.setItem("kiwi_device_token_"+t.profile.user.external_id,n.data.device_token),window.location.replace(decodeURIComponent(t.$route.query.redirect||"/"));case 9:e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0),"OTP_INVALID"===e.t0.response.data.error?t.$notification({text:t.$t("myAccount.verifyOTP.invalid"),color:"red"}):"OTP_EXPIRED"===e.t0.response.data.error?(t.$notification({text:t.$t("myAccount.verifyOTP.expired"),color:"red"}),0===t.time&&t.getOTP()):"OTP_USED"===e.t0.response.data.error?t.$notification({text:t.$t("myAccount.verifyOTP.used"),color:"red"}):"TOKEN_MISSING_PARAMETERS"===e.t0.response.data.error?t.$notification({text:"TOKEN_MISSING_PARAMETER (Contact Support for help)",color:"red"}):"RecaptchaFailed"===e.t0.response.data.error?t.$notification({text:"RecaptchaFailed"}):t.$notification({text:e.t0.response.data.error,color:"red"});case 15:return e.prev=15,t.isLoading=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,11,15,18]])})))()},startTimer:function(){var t=this;localStorage.endTime=+new Date+6e4,setInterval((function(){var e=localStorage.endTime-new Date;e>=0?t.time=Math.floor(e/1e3):this.mounted||(this.mounted=!0)}),100)}}},x=Object(l.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"w-full max-w-3xl mx-auto my-8 px-2"},[n("ModalRecoveryWithSms",{on:{onClose:function(e){t.modalStates.recoveryWithSms=!1},flowUnico:function(e){t.modalStates.recoveryWithUnico=!0}},model:{value:t.modalStates.recoveryWithSms,callback:function(e){t.$set(t.modalStates,"recoveryWithSms",e)},expression:"modalStates.recoveryWithSms"}}),t._v(" "),n("ModalRecoveryWithUnico",{on:{onClose:function(e){t.modalStates.recoveryWithUnico=!1}},model:{value:t.modalStates.recoveryWithUnico,callback:function(e){t.$set(t.modalStates,"recoveryWithUnico",e)},expression:"modalStates.recoveryWithUnico"}}),t._v(" "),n("div",{staticClass:"bg-white p-6 rounded m-2"},[n("div",{staticClass:"text-xl md:text-2xl font-medium"},[t._v(t._s(t.$t("myAccount.verifyOTP.title")))]),t._v(" "),n("p",{staticClass:"text-sm mt-4"},[t._v(t._s(t.$t("defaults.components.otp.disclaimer")))]),t._v(" "),n("div",{staticClass:"mt-4"},[n("MaskInput",{staticClass:"w-64",attrs:{mask:"######",error:t.$v.otp.$error,required:"",type:"tel"},on:{onBlur:function(e){return t.$v.otp.$touch()},enter:t.verifyOTP},model:{value:t.otp,callback:function(e){t.otp=e},expression:"otp"}}),t._v(" "),n("div",{staticClass:"mt-2"},[n("KButton",{attrs:{color:"indigo",isLoading:t.isLoading},on:{onClick:t.verifyOTP}},[t._v(t._s(t.$t("defaults.components.otp.verify")))])],1)],1),t._v(" "),n("div",{staticClass:"text-sm mt-4 flex flex-wrap items-center"},[t._v("\n      "+t._s(0===t.time||t.mounted?t.$t("defaults.components.otp.didNotReceived"):t.$t("defaults.components.otp.resent"))+"\n      "),n("button",{staticClass:"inline-flex focus:outline-none cursor-default items-center md:ml-2",class:{"text-indigo-600 underline cursor-pointer":0===t.time,"cursor-not-allowed":t.loadingStates.otp},attrs:{disabled:t.loadingStates.otp},on:{click:function(e){0===t.time&&t.getOTP(!0)}}},[t.loadingStates.otp?n("svg",{staticClass:"animate-spin h-3 mx-2",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"}},[n("circle",{staticClass:"opacity-25",attrs:{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}}),t._v(" "),n("path",{staticClass:"opacity-75",attrs:{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"}})]):t._e(),t._v(" "),t.loadingStates.otp?t._e():n("div",[t._v("\n          "+t._s(0!==t.time?t.$t("defaults.components.otp.resendAfter",{time:t.time}):t.$t("defaults.components.otp.clickToResend"))+"\n        ")])])]),t._v(" "),t.onboardCompleted?n("p",{staticClass:"text-sm"},[t._v("\n      "+t._s(t.$t("defaults.components.otpSms.noAccessEmail"))+"\n      "),n("label",{staticClass:"font-medium text-indigo-600 hover:text-indigo-500 focus:outline-none focus:underline transition ease-in-out duration-150 cursor-pointer",on:{click:function(e){t.modalStates.recoveryWithSms=!0}}},[t._v("\n        "+t._s(t.$t("defaults.components.otpSms.click"))+"\n      ")])]):t._e()])],1)}),[],!1,null,null,null);e.default=x.exports;installComponents(x,{MaskInput:n(345).default,KButton:n(102).default})}}]);